function t(){$.ajax({type:"GET",url:"../api/beneficios",dataType:"json",beforeSend:function(){$("#floating-loader").fadeIn(200)},complete:function(){$("#floating-loader").fadeOut(200)},success:function(t){$("#d-content").hide(),$("#d-content").html(t.html).fadeIn(),$("#listado-beneficios").DataTable({responsive:!0,columnDefs:[{orderable:!1,targets:[6,7]}],order:[],language:{decimal:"",emptyTable:"No se encontraron resultados",info:"Mostrando _START_ a _END_ de un total de _TOTAL_ entradas",infoEmpty:"Mostrando 0 a 0 de 0 entradas",infoFiltered:"(filtrado de un total de _MAX_ entradas)",infoPostFix:"",thousands:",",lengthMenu:"Mostrar _MENU_ entradas",loadingRecords:"Cargando...",processing:"Procesando...",search:"Buscar:",zeroRecords:"No se encontraron resultados",paginate:{first:"Primero",last:"Ultimo",next:"Siguiente",previous:"Anterior"},aria:{sortAscending:": activar para ordenar columnas de forma acsendente",sortDescending:": activar para ordenar columnas de forma descendente"}}}),$(".modify").click(function(){o($(this).attr("data-val"))}),$(".view").click(function(){e($(this).attr("data-val"))}),$(".reject").click(function(){a($(this).attr("data-val"))}),$(".delete").click(function(){n($(this).attr("data-val"))}),$("#new-button").click(function(){s()}),g()}})}function e(e){$.ajax({type:"GET",url:"../api/beneficios/"+e,dataType:"json",beforeSend:function(){$("#floating-loader").fadeIn(200)},complete:function(){$("#floating-loader").fadeOut(200)},success:function(a){$("#d-content").hide(),$("#d-content").html(a.html).fadeIn(),$(".btn-add").click(function(){var t=$(this).attr("data-val");u(e,t)}),$("#btn-end").click(function(){d(e)}),$(".btn-back").click(function(){t()})}})}function a(e){$.ajax({type:"POST",url:"../api/beneficios/rechazar/"+e,dataType:"json",beforeSend:function(){$("#floating-loader").fadeIn(200)},complete:function(){$("#floating-loader").fadeOut(200)},success:function(e){"success"==e.status?(v(e.status,e.message.title,e.message.body,e.message.timeout),t()):v(e.status,e.message.title,e.message.body,e.message.timeout)}})}function n(e){$.ajax({type:"POST",url:"../api/beneficios/eliminar/"+e,dataType:"json",beforeSend:function(){$("#floating-loader").fadeIn(200)},complete:function(){$("#floating-loader").fadeOut(200)},success:function(e){"success"==e.status?(v(e.status,e.message.title,e.message.body,e.message.timeout),t()):v(e.status,e.message.title,e.message.body,e.message.timeout)}})}function s(){$.ajax({type:"GET",url:"../api/beneficios/create/new",dataType:"json",beforeSend:function(){$("#floating-loader").fadeIn(200)},complete:function(){$("#floating-loader").fadeOut(200)},success:function(e){$("#d-content").hide(),$("#d-content").html(e.html).fadeIn(),g(),$("#create-button").click(function(){c()}),$(".btn-back").click(function(){t()})}})}function o(e){$.ajax({type:"GET",url:"../api/beneficios/edit/"+e,dataType:"json",beforeSend:function(){$("#floating-loader").fadeIn(200)},complete:function(){$("#floating-loader").fadeOut(200)},success:function(a){$("#d-content").hide(),$("#d-content").html(a.html).fadeIn(),g(),$("#modify-button").click(function(){r(e)}),$(".btn-back").click(function(){t()})}})}function c(){if(y($("#user-rut")[0])){var e={rut:$("#user-rut").val(),nombre:$("#user-name").val(),tipo:$("#benefit-type").val(),empresa:$("#user-company").val()};$.ajax({type:"POST",url:"../api/beneficios/store",data:e,dataType:"json",beforeSend:function(){$("#floating-loader").fadeIn(200)},complete:function(){$("#floating-loader").fadeOut(200)},success:function(e){"success"==e.status?(v(e.status,e.message.title,e.message.body,e.message.timeout),t()):v(e.status,e.message.title,e.message.body,e.message.timeout)}})}else v("error","","El rut no es válido",2)}function r(e){var a={id:e,nombre:$("#user-name").val(),estado:$("#benefit-status").val(),tipo:$("#benefit-type").val(),empresa:$("#user-company").val()};$.ajax({type:"POST",url:"../api/beneficios/update",data:a,dataType:"json",beforeSend:function(){$("#floating-loader").fadeIn(200)},complete:function(){$("#floating-loader").fadeOut(200)},success:function(e){"success"==e.status?(v(e.status,e.message.title,e.message.body,e.message.timeout),t()):v(e.status,e.message.title,e.message.body,e.message.timeout)}})}function u(t,a){$.ajax({type:"GET",url:"../api/hitos/"+t+"/"+a,dataType:"json",beforeSend:function(){$("#floating-loader").fadeIn(200)},complete:function(){$("#floating-loader").fadeOut(200)},success:function(n){$("#d-content").hide(),$("#d-content").html(n.html).fadeIn(),g(),$("#create-button").click(function(){l(t,a)});$("#hito-date").pickadate({format:"dd/mm/yyyy",format_submit:!1,closeOnSelect:!1,closeOnClear:!1}).pickadate("picker");$(".btn-back").click(function(){e(t)}),$("#hito-date").click(function(){$(this).parents(".form-input").find("label").addClass("active-input")}),$(".delete").click(function(){var e=$(this).attr("data-val");f(t,e,a)})}})}function l(t,e){var a={ben_id:t,hito_id:$("#hito").val(),detalle:$("#observation").val(),fecha:$("#hito-date").val()};$.ajax({type:"POST",url:"../api/hitos/store",data:a,dataType:"json",beforeSend:function(){$("#floating-loader").fadeIn(200)},complete:function(){$("#floating-loader").fadeOut(200)},success:function(a){"success"==a.status?(v(a.status,a.message.title,a.message.body,a.message.timeout),u(t,e)):v(a.status,a.message.title,a.message.body,a.message.timeout)}})}function f(t,e,a){$.ajax({type:"GET",url:"../api/hitos/destroy/"+t+"/"+e,dataType:"json",beforeSend:function(){$("#floating-loader").fadeIn(200)},complete:function(){$("#floating-loader").fadeOut(200)},success:function(e){"success"==e.status?(v(e.status,e.message.title,e.message.body,e.message.timeout),u(t,a)):v(e.status,e.message.title,e.message.body,e.message.timeout)}})}function d(t){$.ajax({type:"POST",url:"../api/etapa/finalizar/"+t,dataType:"json",beforeSend:function(){$("#floating-loader").fadeIn(200)},complete:function(){$("#floating-loader").fadeOut(200)},success:function(a){"success"==a.status?(v(a.status,a.message.title,a.message.body,a.message.timeout),e(t)):v(a.status,a.message.title,a.message.body,a.message.timeout)}})}function m(){$.ajax({type:"GET",url:"../api/usuario/edit",dataType:"json",beforeSend:function(){$("#floating-loader").fadeIn(200)},complete:function(){$("#floating-loader").fadeOut(200)},success:function(t){$("#d-content").hide(),$("#d-content").html(t.html).fadeIn(),g(),$("#create-button").click(function(){p()})}})}function p(){var e={pass:$("#pass").val(),newpass1:$("#newpass1").val(),newpass2:$("#newpass2").val()};$.ajax({type:"POST",url:"../api/usuario/update",data:e,dataType:"json",beforeSend:function(){$("#floating-loader").fadeIn(200)},complete:function(){$("#floating-loader").fadeOut(200)},success:function(e){if("success"==e.status){v(e.status,e.message.title,e.message.body,e.message.timeout),t();var a=$(".navbar").children();a.removeClass("nav-element-active"),a.first().addClass("nav-element-active")}else v(e.status,e.message.title,e.message.body,e.message.timeout)}})}function g(){$("input, textarea").focusin(function(){$(this).parents(".form-input").find("label").addClass("active-input")}),$("input, textarea").off("focusin"),$("input, textarea").focusin(function(){$(this).parents(".form-input").find("label").addClass("active-input")}),$("input, textarea").off("focusout"),$("input, textarea").focusout(function(){var t=$(this).parents(".form-input").find("label");"hito-date"!=this.id&&""==$(this).val()&&t.hasClass("active-input")&&t.removeClass("active-input")}),$("input, textarea").each(function(t){""!=$(this).val()&&$(this).parents(".form-input").find("label").addClass("active-input")}),$("select").each(function(t){$(this).parents(".form-input").find("label").addClass("active-input")}),$("textarea").each(function(t){$(this).parents(".form-input").find("label").addClass("label-select")})}function h(){var e=$(".navbar").children();e.click(function(){e.removeClass("nav-element-active"),$(this).addClass("nav-element-active")}),$("#main-title").text("Beneficios habitacionales"),$("#beneficios-nav").click(function(){t(),$("#main-title").text("Beneficios habitacionales")}),$("#salir-nav").click(function(){b(),$("#main-title").text("Hasta pronto!")}),$("#cuenta-nav").click(function(){m(),$("#main-title").text("Gestión de cuenta")}),$("#main-title").text("Beneficios habitacionales")}function b(){$.ajax({type:"POST",url:"../api/logout",dataType:"json",beforeSend:function(){$("#floating-loader").fadeIn(200)},complete:function(){$("#floating-loader").fadeOut(200)},success:function(t){"success"==t.status&&(window.location.href="../login/")}})}function v(t,e,a,n){var s=$(".d-toast").length,i="";switch(t){case"success":i=" d-toast-success";break;case"error":i=" d-toast-error";break;case"notify":i=" d-toast-notify";break;case"warning":i=" d-toast-warning"}var o="";o+='<div id="toast_'+s+'" class="d-toast fadeInTop'+i+'">',o+="<strong>"+e+"</strong>",o+=" "+a+".",o+="</div>",$("body").append(o),$("#toast_"+s).show();var c=80+50*s;$("#toast_"+s).css("top",c),setTimeout(function(){$("#toast_"+s).removeClass("fadeInTop"),$("#toast_"+s).addClass("fadeOutTop"),setTimeout(function(){$("#toast_"+s).remove()},500)},1e3*n)}function y(t){var e=t.value,a="";for(i=0;i<e.length;i++)" "!=e.charAt(i)&&"."!=e.charAt(i)&&"-"!=e.charAt(i)&&(a+=e.charAt(i));if(e=a,largo=e.length,""!=e&&largo<8)return!1;for(i=0;i<largo;i++)if("0"!=e.charAt(i)&&"1"!=e.charAt(i)&&"2"!=e.charAt(i)&&"3"!=e.charAt(i)&&"4"!=e.charAt(i)&&"5"!=e.charAt(i)&&"6"!=e.charAt(i)&&"7"!=e.charAt(i)&&"8"!=e.charAt(i)&&"9"!=e.charAt(i)&&"k"!=e.charAt(i)&&"K"!=e.charAt(i))return t.focus(),t.select(),!1;var n="";for(i=largo-1,j=0;i>=0;i--,j++)n+=e.charAt(i);var s="";for(s+=n.charAt(0),s+="-",cnt=0,i=1,j=2;i<largo;i++,j++)3==cnt?(s+=".",j++,s+=n.charAt(i),cnt=1):(s+=n.charAt(i),cnt++);for(n="",i=s.length-1,j=0;i>=0;i--,j++)n+=s.charAt(i);return t.value=n.toUpperCase(),A(t,e)}function A(t,e){"-"==t.value&&(t.value="");var a,n,s;if((a=e.length)<8&&a>3)return!1;if(n=a>2?e.substring(0,a-1):e.charAt(0),s=e.charAt(a-1),null==n||null==s)return!0;if(""==n||""==s)return!0;var o="0";for(suma=0,mul=2,i=n.length-1;i>=0;i--)suma+=n.charAt(i)*mul,7==mul?mul=2:mul++;return res=suma%11,1==res?o="k":0==res?o="0":(dvi=11-res,o=dvi+""),o==s.toLowerCase()}function T(t){if(""!=t){for(var e,a,n,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="",o=0,c=t.length;o<c;){if(e=255&t.charCodeAt(o++),o==c){i+=s.charAt(e>>2),i+=s.charAt((3&e)<<4),i+="==";break}if(a=t.charCodeAt(o++),o==c){i+=s.charAt(e>>2),i+=s.charAt((3&e)<<4|(240&a)>>4),i+=s.charAt((15&a)<<2),i+="=";break}n=t.charCodeAt(o++),i+=s.charAt(e>>2),i+=s.charAt((3&e)<<4|(240&a)>>4),i+=s.charAt((15&a)<<2|(192&n)>>6),i+=s.charAt(63&n)}return i}return!1}$(document).ready(function(){t(),h()});